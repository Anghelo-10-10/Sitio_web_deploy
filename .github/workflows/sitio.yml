name: 
Sitio_web_deploy
on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch: # Permite ejecutar manualmente

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout Repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0 # Fetch full history for better git info
    
    - name: ğŸ”§ Setup Node.js (si fuera necesario)
      uses: actions/setup-node@v4
      with:
        node-version: '18'
    
    - name: ğŸ“Š Display Build Information
      run: |
        echo "ğŸš€ Iniciando deploy con token personalizado"
        echo "ğŸ“‚ Repositorio: ${{ github.repository }}"
        echo "ğŸŒŸ Commit: ${{ github.sha }}"
        echo "ğŸ‘¤ Actor: ${{ github.actor }}"
        echo "ğŸ“… Fecha: $(date)"
        echo "ğŸ”‘ Usando token personalizado (no GITHUB_TOKEN)"
    
    - name: ğŸ—ï¸ Build Process (PreparaciÃ³n de archivos)
      run: |
        echo "Preparando archivos para despliegue..."
        
        # Crear informaciÃ³n de build
        echo "Build ID: GHA-$(date +%Y%m%d-%H%M%S)" > build-info.txt
        echo "Commit: ${{ github.sha }}" >> build-info.txt
        echo "Branch: ${{ github.ref_name }}" >> build-info.txt
        echo "Actor: ${{ github.actor }}" >> build-info.txt
        echo "Fecha: $(date)" >> build-info.txt
        
        # Mostrar estructura de archivos
        echo "ğŸ“ Estructura de archivos:"
        ls -la
        
        # Validar archivos HTML
        if [ -f "index.html" ]; then
          echo "âœ… index.html encontrado"
        else
          echo "âŒ index.html no encontrado"
          exit 1
        fi
    
    - name: ğŸš€ Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        personal_token: ${{ secrets.GH_PAT }}  # Â¡AquÃ­ usamos nuestro token personalizado!
        publish_dir: ./
        publish_branch: gh-pages
        user_name: 'github-actions[bot]'
        user_email: 'github-actions[bot]@users.noreply.github.com'
        commit_message: |
          ğŸš€ Deploy: ${{ github.event.head_commit.message }}
          
          - Commit: ${{ github.sha }}
          - Branch: ${{ github.ref_name }}
          - Actor: ${{ github.actor }}
          - Timestamp: ${{ github.event.head_commit.timestamp }}
    
    - name: ğŸ“‹ Post-Deploy Information
      run: |
        echo "âœ… Deploy completado exitosamente"
        echo "ğŸŒ URL del sitio: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}"
        echo "ğŸ“Š Logs disponibles en: https://github.com/${{ github.repository }}/actions"
        echo "ğŸ”‘ Token personalizado utilizado correctamente"
